<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Order History</title>
<style>
body { font-family: Arial; padding: 20px; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
</style>
</head>
<body>
<h2>Order History</h2>
<table>
    <thead>
        <tr>
            <th>Order ID</th><th>Total</th><th>Items</th><th>Date</th>
        </tr>
    </thead>
    <tbody id="orders-body"></tbody>
</table>

<script>
const API_URL = "";
const token = localStorage.getItem('token');
if(!token) {
    alert("Please login first");
    window.location.href = "/login-page";
}

async function loadOrders() {
    const res = await fetch(`${API_URL}/orders/history`, {
        headers: { "Authorization": `Bearer ${token}` }
    });
    const orders = await res.json();
    const tbody = document.getElementById('orders-body');
    tbody.innerHTML = '';
    
    orders.forEach(order => {
        const itemsList = order.items.map(item => `${item.product_name} (x${item.quantity})`).join(', ');
        tbody.innerHTML += `
            <tr>
                <td>${order.id}</td>
                <td>$${order.total.toFixed(2)}</td>
                <td>${itemsList}</td>
                <td>${new Date(order.created_at).toLocaleString()}</td>
            </tr>
        `;
    });
}

loadOrders();
</script>
</body>
</html>
